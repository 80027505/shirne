function del(t,n){return dialog.confirm(n,function(){location.href=$(t).attr("href")}),!1}function lang(t){return window.language&&window.language[t]?window.language[t]:t}function randomString(t,n){for(var i="",e=(n=n||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,o=0;o<t;o++){var a=Math.floor(Math.random()*e);i+=n.substring(a,a+1)}return i}function copy_obj(t){return JSON.parse(JSON.stringify(t))}function isObjectValueEqual(t,n){if(!t&&!n)return!0;if(!t||!n)return!1;var i=Object.getOwnPropertyNames(t),e=Object.getOwnPropertyNames(n);if(i.length!=e.length)return!1;for(var o=0;o<i.length;o++){var a=i[o];if(t[a]!==n[a])return!1}return!0}function array_combine(t,n){for(var i={},e=0;e<t.length&&!(n.length<e+1);e++)i[t[e]]=n[e];return i}function tostring(t){return t&&t.toString?t.toString():""}function callfunc(t,n,i,e){if(i){"string"==typeof i&&(i=i.split(","));var o=i.indexOf("###");0<=o?i[o]=t:i=[t].concat(i)}else i=[t];return window[n]?window[n].apply(e,i):null==t?"":t}function iif(t,n,i){return"0"===t&&(t=0),t?n:i}Number.prototype.format=function(t){void 0===t&&(t=2);for(var n=this.toFixed(t).split("."),i=[],e=n[0].split(""),o=e.length,a=0;a<o;a++)0<a&&a%3==0&&i.unshift(","),i.unshift(e[o-a-1]);return i.join("")+(2==n.length?"."+n[1]:"")},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s+|\s+$)/g,"")}),String.prototype.compile=function(r,t){if(t){var n=[];for(var i in r)n.push(this.compile(r[i]));return n.join("\n")}return this.replace(/\{if\s+([^\}]+)\}([\W\w]*){\/if}/g,function(t,n,i){var e;if(e=n.match(/\s+(=+|<|>)\s+/)){e=e[0];var o=n.split(e);0===o[0].indexOf("@")&&(o[0]=r[o[0].replace("@","")]),0===o[1].indexOf("@")&&(o[1]=r[o[1].replace("@","")]);var a=!1;switch(e=e.trim()){case"==":a=o[0]==o[1];break;case"===":a=o[0]===o[1];break;case">":a=o[0]>o[1];break;case"<":a=o[0]<o[1]}if(a)return i}else if(r[n.replace("@","")])return i;return""}).replace(/\{@([\w\d\.]+)(?:\|([\w\d]+)(?:\s*=\s*([\w\d,\s#]+))?)?\}/g,function(t,n,i,e){if(0<n.indexOf(".")){for(var o=n.split("."),a=r,s=0;s<o.length;s++){if(void 0===a[o[s]]||null===a[o[s]]){a="";break}a=a[o[s]]}return callfunc(a,i,e)}return callfunc(r[n],i,e,r)})};var dialogTpl='<div class="modal fade" id="{@id}" tabindex="-1" role="dialog" aria-labelledby="{@id}Label" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h4 class="modal-title" id="{@id}Label"></h4>\n                <button type="button" class="close" data-dismiss="modal">\n                    <span aria-hidden="true">&times;</span>\n                    <span class="sr-only">Close</span>\n                </button>\n            </div>\n            <div class="modal-body">\n            </div>\n            <div class="modal-footer">\n                <nav class="nav nav-fill"></nav>\n            </div>\n        </div>\n    </div>\n</div>',dialogIdx=0;function Dialog(t){if(t||(t={}),void 0!==t.btns){"string"==typeof t.btns&&(t.btns=[t.btns]);for(var n=0;n<t.btns.length;n++)"string"==typeof t.btns[n]&&(t.btns[n]={text:t.btns[n]}),t.btns[n].isdefault&&(t.defaultBtn=n);void 0===t.defaultBtn&&(t.defaultBtn=t.btns.length-1,t.btns[t.defaultBtn].isdefault=!0),t.btns[t.defaultBtn]&&!t.btns[t.defaultBtn].type&&(t.btns[t.defaultBtn].type="primary")}this.options=$.extend({id:"dlgModal"+dialogIdx++,header:!0,backdrop:!0,size:"",btns:[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}],defaultBtn:1,onsure:null,onshow:null,onshown:null,onhide:null,onhidden:null},t),this.box=$(this.options.id)}Dialog.prototype.generBtn=function(t,n){return t.type&&(t.class="btn-outline-"+t.type),'<a href="javascript:" class="nav-item btn '+(t.class?t.class:"btn-outline-secondary")+'" data-index="'+n+'">'+t.text+"</a>"},Dialog.prototype.show=function(t,n){this.box=$("#"+this.options.id),n||(n="系统提示"),this.box.length<1?($(document.body).append(dialogTpl.replace("modal-body","modal-body"+(this.options.bodyClass?" "+this.options.bodyClass:"")).compile({id:this.options.id})),this.box=$("#"+this.options.id)):this.box.unbind(),this.options.header||this.box.find(".modal-header").remove(),!0!==this.options.backdrop&&this.box.data("backdrop",this.options.backdrop),this.options.keyboard||this.box.data("keyboard",!1);var i=this;Dialog.instance=i;for(var e=[],o=0;o<this.options.btns.length;o++)e.push(this.generBtn(this.options.btns[o],o));this.box.find(".modal-footer .nav").html(e.join("\n"));var a=this.box.find(".modal-dialog");a.removeClass("modal-sm").removeClass("modal-lg"),"sm"==this.options.size?a.addClass("modal-sm"):"lg"==this.options.size&&a.addClass("modal-lg"),this.box.find(".modal-title").text(n);var s=this.box.find(".modal-body");return s.html(t),this.box.on("hide.bs.modal",function(){i.options.onhide&&i.options.onhide(s,i.box),Dialog.instance=null}),this.box.on("hidden.bs.modal",function(){i.options.onhidden&&i.options.onhidden(s,i.box),i.box.remove()}),this.box.on("show.bs.modal",function(){i.options.onshow&&i.options.onshow(s,i.box)}),this.box.on("shown.bs.modal",function(){i.options.onshown&&i.options.onshown(s,i.box)}),this.box.find(".modal-footer .btn").click(function(){var t=!0,n=$(this).data("index");i.options.btns[n].click&&(t=i.options.btns[n].click.apply(this,[s,i.box])),n==i.options.defaultBtn&&i.options.onsure&&(t=i.options.onsure.apply(this,[s,i.box])),!1!==t&&i.box.modal("hide")}),this.box.modal("show"),this},Dialog.prototype.hide=Dialog.prototype.close=function(){return this.box.modal("hide"),this};var dialog={alert:function(t,n,i){var e=!1,o="function"==typeof n;n&&!o&&(i=n);var a={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},s="primary";i?a[i]&&(s="error"==i?"danger":i,i=a[i]):i="information-circle";var r='<div class="row" style="align-items: center;"><div class="col-4 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-8" >{@message}</div> </div>'.compile({message:t,icon:i,color:s});return new Dialog({btns:"确定",header:!1,onsure:function(){if(o)return n(e=!0)},onhide:function(){!e&&o&&n(!1)}}).show(r,"")},confirm:function(t,n,i,e){var o=!1;"string"==typeof n?(e=n,"function"==typeof i&&(n=i,i=null)):"string"==typeof calcel&&(e=i);var a={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},s="primary";e?a[e]&&(s="error"==e?"danger":e,e=a[e]):e="information-circle";var r='<div class="row" style="align-items: center;"><div class="col-4 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-8" >{@message}</div> </div>'.compile({message:t,icon:e,color:s});return new Dialog({header:!1,backdrop:"static",onsure:function(){if(n&&"function"==typeof n)return o=!0,n()},onhide:function(){if(0==o&&"function"==typeof i)return i()}}).show(r)},prompt:function(n,e,t){var i='<div class="form-group">{@input}</div>',o="请输入信息";return"string"==typeof n?o=n:(o=n.title,n.content&&(i=-1<n.content.indexOf("{@input}")?n.content:n.content+i)),new Dialog({backdrop:"static",onshow:function(t){n&&n.onshow&&n.onshow(t)},onshown:function(t){t.find("[name=confirm_input]").focus(),n&&n.onshown&&n.onshown(t)},onsure:function(t){var n=t.find("[name=confirm_input]").val();if("function"==typeof e){var i=e(n);return!0===i&&!0,i}},onhide:function(){if(!1)return t()}}).show(i.compile({input:'<input type="text" name="confirm_input" class="form-control" />'}),o)},action:function(t,i,n){var e='<div class="list-group"><a href="javascript:" class="list-group-item list-group-item-action">'+t.join('</a><a href="javascript:" class="list-group-item list-group-item-action">')+"</a></div>",o=null,a=new Dialog({bodyClass:"modal-action",backdrop:"static",btns:[{text:"取消",type:"secondary"}],onshow:function(t){(o=t.find(".list-group-item-action")).click(function(t){o.removeClass("active"),$(this).addClass("active");var n=o.index(this);"function"==typeof i?!1!==i(n)&&a.close():a.close()})},onsure:function(t){return!0},onhide:function(){return!0}}).show(e,n||"请选择")},pickList:function(s,n,r){"string"==typeof s&&(s={url:s}),s=$.extend({url:"",name:"对象",searchHolder:"根据名称搜索",idkey:"id",onRow:null,extend:null,rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">[{@id}]&nbsp;<i class="ion-md-person"></i> {@username}&nbsp;&nbsp;&nbsp;<small><i class="ion-md-phone-portrait"></i> {@mobile}</small></a>'},s||{});var l=null,t="";s.extend&&(t='<select name="'+s.extend.name+'" class="form-control"><option value="">'+s.extend.title+"</option></select>"),r||(r={});new Dialog({backdrop:"static",onshown:function(t){var n=t.find(".searchbtn"),i=t.find(".searchtext"),e=t.find(".list-group"),o=!1,a=null;s.extend&&(a=t.find("[name="+s.extend.name+"]"),$.ajax({url:s.extend.url,type:"GET",dataType:"JSON",success:function(t){a.append(s.extend.htmlRow.compile(t.data,!0))}})),n.click(function(){o||(o=!0,e.html('<span class="list-loading">加载中...</span>'),r.key=i.val(),s.extend&&(r[s.extend.name]=a.val()),$.ajax({url:s.url,type:"GET",dataType:"JSON",data:r,success:function(i){o=!1,1===i.code?i.data&&i.data.length?(e.html(s.rowTemplate.compile(i.data,!0)),e.find("a.list-group-item").click(function(){for(var t=$(this).data("id"),n=0;n<i.data.length;n++)if(i.data[n][s.idkey]==t){l=i.data[n],e.find("a.list-group-item").removeClass("active"),$(this).addClass("active");break}})):e.html('<span class="list-loading"><i class="ion-md-warning"></i> 没有检索到'+s.name+"</span>"):e.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>')}}))}).trigger("click")},onsure:function(t){return l?"function"==typeof n?n(l):void 0:(toastr.warning("没有选择"+s.name+"!"),!1)}}).show('<div class="input-group">'+t+'<input type="text" class="form-control searchtext" name="keyword" placeholder="'+s.searchHolder+'"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="list-group list-group-picker mt-2"></div>',"请搜索并选择"+s.name)},pickUser:function(t,n){return this.pickList({url:window.get_search_url("member"),name:"会员",searchHolder:"根据会员id或名称，电话来搜索"},t,n)},pickArticle:function(t,n){return this.pickList({url:window.get_search_url("article"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @cover}<div style="background-image:url({@cover})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@description}</div></a>',name:"文章",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("article"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据文章标题搜索"},t,n)},pickProduct:function(t,n){return this.pickList({url:window.get_search_url("product"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @image}<div style="background-image:url({@image})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@min_price}~{@max_price}</div></a>',name:"产品",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("product"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据产品名称搜索"},t,n)},pickLocate:function(t,n,s){var r=null;new Dialog({size:"lg",backdrop:"static",onshown:function(t){var n=t.find(".searchbtn"),i=t.find(".searchtext"),e=t.find(".map"),o=t.find(".mapinfo");e.css("height",.6*$(window).height());var a=InitMap("tencent",e,function(t,n){o.html(t+"&nbsp;"+n.lng+","+n.lat),r=n},s);n.click(function(){var t=i.val();a.setLocate(t)}),t.find(".setToCenter").click(function(t){a.showAtCenter()})},onsure:function(t){return r?"function"==typeof n?n(r):void 0:(toastr.warning("没有选择位置!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="填写地址检索位置"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="map mt-2"></div><div class="float-right mt-2 mapactions"><a href="javascript:" class="setToCenter">定位到地图中心</a></div><div class="mapinfo mt-2 text-muted">未选择位置</div>',"请选择地图位置")}};if(jQuery(function(t){t(document).on("keydown",function(t){if(Dialog.instance){var n=Dialog.instance;13==t.keyCode&&n.box.find(".modal-footer .btn").eq(n.options.defaultBtn).trigger("click")}})}),jQuery.extend(jQuery.fn,{tags:function(t,o){var a=[],s='<span class="badge badge-info">{@label}<input type="hidden" name="'+t+'" value="{@label}"/><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></span>',n=$(this).parents(".form-control"),r=$('<span class="badge-group"></span>'),l=this;this.before(r),this.on("keyup",function(){var t=$(this).val().replace(/，/g,","),n=!1;if(t&&-1<t.indexOf(",")){for(var i=t.split(","),e=0;e<i.length;e++)i[e]=i[e].replace(/^\s|\s$/g,""),i[e]&&-1===a.indexOf(i[e])&&(a.push(i[e]),r.append(s.compile({label:i[e]})),n=!0);l.val(""),n&&o&&o(a)}}).on("blur",function(){var t=$(this).val();t&&$(this).val(t+",").trigger("keyup")}).trigger("blur"),r.on("click",".close",function(){var t=$(this).parents(".badge").find("input").val(),n=a.indexOf(t);n&&a.splice(n,1),$(this).parents(".badge").remove(),o&&o(a)}),n.click(function(){l.focus()})}}),$.fn.datetimepicker){var tooltips={today:"定位当前日期",clear:"清除已选日期",close:"关闭选择器",selectMonth:"选择月份",prevMonth:"上个月",nextMonth:"下个月",selectYear:"选择年份",prevYear:"上一年",nextYear:"下一年",selectDecade:"选择年份区间",selectTime:"选择时间",prevDecade:"上一区间",nextDecade:"下一区间",prevCentury:"上个世纪",nextCentury:"下个世纪"};function transOption(t){if(!t)return{};var n={};for(var i in t)switch(i){case"viewmode":n.viewMode=t[i];break;case"keepopen":n.keepOpen=t[i];break;default:n[i]=t[i]}return n}$(".datepicker").each(function(){var t=$.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},transOption($(this).data()));$(this).datetimepicker(t)}),$(".date-range").each(function(){var t=$(this).find("[name=fromdate],.fromdate"),n=$(this).find("[name=todate],.todate"),i=$.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},$(this).data());t.datetimepicker(i).on("dp.change",function(){t.val()&&n.data("DateTimePicker").minDate(t.val())}),n.datetimepicker(i).on("dp.change",function(){n.val()&&t.data("DateTimePicker").maxDate(n.val())})})}function setNav(t){for(var n=$(".main-nav .nav-item"),i=!1,e=0;e<n.length;e++)if(n.eq(e).data("model")===t){n.eq(e).addClass("active"),i=!0;break}!i&&0<t.indexOf("-")&&setNav(t=t.substr(0,t.lastIndexOf("-")))}jQuery(function(e){991<=e(window).width()?e(".main-nav>.dropdown").hover(function(){e(this).find(".dropdown-menu").stop(!0,!1).slideDown()},function(){e(this).find(".dropdown-menu").stop(!0,!1).slideUp()}):e(".main-nav>.dropdown>.dropdown-toggle").click(function(t){t.preventDefault(),t.stopPropagation();var n=e(this).data("opened"),i=e(this).parents(".dropdown");n?i.find(".dropdown-menu").stop(!0,!1).slideUp():(i.siblings().children(".dropdown-menu").stop(!0,!1).slideUp(),i.siblings().children(".dropdown-toggle").data("opened",!1),i.find(".dropdown-menu").stop(!0,!1).slideDown()),e(this).data("opened",!n)})});