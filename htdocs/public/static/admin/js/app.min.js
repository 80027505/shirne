function del(t,o){return dialog.confirm(o,function(){location.href=$(t).attr("href")}),!1}function randomString(t,o){for(var n="",i=(o=o||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,e=0;e<t;e++){var a=Math.floor(Math.random()*i);n+=o.substring(a,a+1)}return n}function copy_obj(t){return JSON.parse(JSON.stringify(t))}function isObjectValueEqual(t,o){if(!t&&!o)return!0;if(!t||!o)return!1;var n=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(o);if(n.length!=i.length)return!1;for(var e=0;e<n.length;e++){var a=n[e];if(t[a]!==o[a])return!1}return!0}function array_combine(t,o){for(var n={},i=0;i<t.length&&!(o.length<i+1);i++)n[t[i]]=o[i];return n}function callfunc(t,o,n,i){if(n){"string"==typeof n&&(n=n.split(","));var e=n.indexOf("###");0<=e?n[e]=t:n=[t].concat(n)}else n=[t];return window[o]?window[o].apply(i,n):t}function iif(t,o,n){return"0"===t&&(t=0),t?o:n}Number.prototype.format=function(t){void 0===t&&(t=2);for(var o=this.toFixed(t).split("."),n=[],i=o[0].split(""),e=i.length,a=0;a<e;a++)0<a&&a%3==0&&n.unshift(","),n.unshift(i[e-a-1]);return n.join("")+(2==o.length?"."+o[1]:"")},String.prototype.compile=function(r,t){if(t){var o=[];for(var n in r)o.push(this.compile(r[n]));return o.join("\n")}return this.replace(/\{@([\w\d\.]+)(?:\|([\w\d]+)(?:\s*=\s*([\w\d,\s#]+))?)?\}/g,function(t,o,n,i){if(0<o.indexOf(".")){for(var e=o.split("."),a=r,s=0;s<e.length;s++){if(void 0===a[e[s]]){a="";break}a=a[e[s]]}return callfunc(a,n,i)}return void 0!==r[o]?callfunc(r[o],n,i,r):""})};var dialogTpl='<div class="modal fade" id="{@id}" tabindex="-1" role="dialog" aria-labelledby="{@id}Label" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h4 class="modal-title" id="{@id}Label"></h4>\n                <button type="button" class="close" data-dismiss="modal">\n                    <span aria-hidden="true">&times;</span>\n                    <span class="sr-only">Close</span>\n                </button>\n            </div>\n            <div class="modal-body">\n            </div>\n            <div class="modal-footer">\n                <nav class="nav nav-fill"></nav>\n            </div>\n        </div>\n    </div>\n</div>',dialogIdx=0;function Dialog(t){if(t||(t={}),void 0!==t.btns){"string"==typeof t.btns&&(t.btns=[t.btns]);for(var o=-1,n=0;n<t.btns.length;n++)"string"==typeof t.btns[n]&&(t.btns[n]={text:t.btns[n]}),t.btns[n].isdefault&&(o=n);o<0&&(o=t.btns.length-1,t.btns[o].isdefault=!0),t.btns[o].type||(t.btns[o].type="primary"),t.defaultBtn=o}this.options=$.extend({id:"dlgModal"+dialogIdx++,size:"",btns:[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}],defaultBtn:1,onsure:null,onshow:null,onshown:null,onhide:null,onhidden:null},t),this.box=$(this.options.id)}Dialog.prototype.generBtn=function(t,o){return t.type&&(t.class="btn-outline-"+t.type),'<a href="javascript:" class="nav-item btn '+(t.class?t.class:"btn-outline-secondary")+'" data-index="'+o+'">'+t.text+"</a>"},Dialog.prototype.show=function(t,o){this.box=$("#"+this.options.id),o||(o="系统提示"),this.box.length<1?($(document.body).append(dialogTpl.compile({id:this.options.id})),this.box=$("#"+this.options.id)):this.box.unbind();var n=this;Dialog.instance=n;for(var i=[],e=0;e<this.options.btns.length;e++)i.push(this.generBtn(this.options.btns[e],e));this.box.find(".modal-footer .nav").html(i.join("\n"));var a=this.box.find(".modal-dialog");a.removeClass("modal-sm").removeClass("modal-lg"),"sm"==this.options.size?a.addClass("modal-sm"):"lg"==this.options.size&&a.addClass("modal-lg"),this.box.find(".modal-title").text(o);var s=this.box.find(".modal-body");return s.html(t),this.box.on("hide.bs.modal",function(){n.options.onhide&&n.options.onhide(s,n.box),Dialog.instance=null}),this.box.on("hidden.bs.modal",function(){n.options.onhidden&&n.options.onhidden(s,n.box),n.box.remove()}),this.box.on("show.bs.modal",function(){n.options.onshow&&n.options.onshow(s,n.box)}),this.box.on("shown.bs.modal",function(){n.options.onshown&&n.options.onshown(s,n.box)}),this.box.find(".modal-footer .btn").click(function(){var t=!0,o=$(this).data("index");n.options.btns[o].click&&(t=n.options.btns[o].click.apply(this,[s,n.box])),o==n.options.defaultBtn&&n.options.onsure&&(t=n.options.onsure.apply(this,[s,n.box])),!1!==t&&n.box.modal("hide")}),this.box.modal("show"),this},Dialog.prototype.hide=Dialog.prototype.close=function(){return this.box.modal("hide"),this};var dialog={alert:function(t,o,n){var i=!1,e="function"==typeof o;return new Dialog({btns:"确定",onsure:function(){if(e)return o(i=!0)},onhide:function(){!i&&e&&o(!1)}}).show(t,n)},confirm:function(t,o,n){return new Dialog({onsure:function(){if("function"==typeof o)return!0,o()},onhide:function(){if(!1)return n()}}).show(t)},prompt:function(o,i,t){var n='<div class="form-group">{@input}</div>',e="请输入信息";return"string"==typeof o?e=o:(e=o.title,o.content&&(n=-1<o.content.indexOf("{@input}")?o.content:o.content+n)),new Dialog({onshow:function(t){o&&o.onshow&&o.onshow(t)},onshown:function(t){t.find("[name=confirm_input]").focus(),o&&o.onshown&&o.onshown(t)},onsure:function(t){var o=t.find("[name=confirm_input]").val();if("function"==typeof i){var n=i(o);return!0===n&&!0,n}},onhide:function(){if(!1)return t()}}).show(n.compile({input:'<input type="text" name="confirm_input" class="form-control" />'}),e)},action:function(t,i,o){var n='<div class="list-group"><a href="javascript:" class="list-group-item list-group-item-action">'+t.join('</a><a href="javascript:" class="list-group-item list-group-item-action">')+"</a></div>",e=null;new Dialog({onshow:function(t){(e=t.find(".list-group-item-action")).click(function(t){e.removeClass("active"),$(this).addClass("active")})},onsure:function(t){var o=e.filter(".active");if(0<o.length){var n=e.index(o);if("function"==typeof i)return i(n)}return!1},onhide:function(){return!0}}).show(n,o||"请选择")},pickUser:function(a,o,s){var r=null;s||(s={});new Dialog({onshown:function(t){var o=t.find(".searchbtn"),n=t.find(".searchtext"),i=t.find(".list-group"),e=!1;o.click(function(){e||(e=!0,i.html('<span class="list-loading">加载中...</span>'),s.key=n.val(),$.ajax({url:a,type:"GET",dataType:"JSON",data:s,success:function(n){e=!1,n.status?n.data&&n.data.length?(i.html('<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">[{@id}]&nbsp;<i class="ion-md-person"></i> {@username}&nbsp;&nbsp;&nbsp;<small><i class="ion-md-phone-portrait"></i> {@mobile}</small></a>'.compile(n.data,!0)),i.find("a.list-group-item").click(function(){for(var t=$(this).data("id"),o=0;o<n.data.length;o++)if(n.data[o].id==t){r=n.data[o],i.find("a.list-group-item").removeClass("active"),$(this).addClass("active");break}})):i.html('<span class="list-loading"><i class="ion-md-warning"></i> 没有检索到会员</span>'):i.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>')}}))}).trigger("click")},onsure:function(t){return r?"function"==typeof o?o(r):void 0:(toastr.warning("没有选择会员!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="根据会员id或名称，电话来搜索"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="list-group mt-2"></div>',"请搜索并选择会员")},pickLocate:function(t,o,s){var r=null;new Dialog({size:"lg",onshown:function(t){var o=t.find(".searchbtn"),n=t.find(".searchtext"),i=t.find(".map"),e=t.find(".mapinfo");i.css("height",.6*$(window).height());var a=InitMap("tencent",i,function(t,o){e.html(t+"&nbsp;"+o.lng+","+o.lat),r=o},s);o.click(function(){var t=n.val();a.setLocate(t)})},onsure:function(t){return r?"function"==typeof o?o(r):void 0:(toastr.warning("没有选择位置!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="填写地址检索位置"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="map mt-2"></div><div class="mapinfo mt-2 text-muted">未选择位置</div>',"请选择地图位置")}};if(jQuery(function(t){t(document).on("keydown",function(t){if(Dialog.instance){var o=Dialog.instance;13==t.keyCode&&o.box.find(".modal-footer .btn").eq(o.options.defaultBtn).trigger("click")}})}),jQuery.extend(jQuery.fn,{tags:function(t,e){var a=[],s='<span class="badge badge-info">{@label}<input type="hidden" name="'+t+'" value="{@label}"/><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></span>',o=$(this).parents(".form-control"),r=$('<span class="badge-group"></span>'),l=this;this.before(r),this.on("keyup",function(){var t=$(this).val().replace(/，/g,","),o=!1;if(t&&-1<t.indexOf(",")){for(var n=t.split(","),i=0;i<n.length;i++)n[i]=n[i].replace(/^\s|\s$/g,""),n[i]&&-1===a.indexOf(n[i])&&(a.push(n[i]),r.append(s.compile({label:n[i]})),o=!0);l.val(""),o&&e&&e(a)}}).on("blur",function(){var t=$(this).val();t&&$(this).val(t+",").trigger("keyup")}).trigger("blur"),r.on("click",".close",function(){var t=$(this).parents(".badge").find("input").val(),o=a.indexOf(t);o&&a.splice(o,1),$(this).parents(".badge").remove(),e&&e(a)}),o.click(function(){l.focus()})}}),$.fn.datetimepicker){var tooltips={today:"定位当前日期",clear:"清除已选日期",close:"关闭选择器",selectMonth:"选择月份",prevMonth:"上个月",nextMonth:"下个月",selectYear:"选择年份",prevYear:"上一年",nextYear:"下一年",selectDecade:"选择年份区间",prevDecade:"上一区间",nextDecade:"下一区间",prevCentury:"上个世纪",nextCentury:"下个世纪"},icons={time:"ion-md-time",date:"ion-md-calendar",up:"ion-md-arrow-dropup",down:"ion-md-arrow-dropdown",previous:"ion-md-arrow-dropleft",next:"ion-md-arrow-dropright",today:"ion-md-today",clear:"ion-md-trash",close:"ion-md-close"};$(".datepicker").each(function(){var t=$.extend({icons:icons,tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},$(this).data());$(this).datetimepicker(t)}),$(".date-range").each(function(){var t=$(this).find("[name=fromdate],.fromdate"),o=$(this).find("[name=todate],.todate"),n=$.extend({icons:icons,tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},$(this).data());t.datetimepicker(n).on("dp.change",function(){t.val()&&o.data("DateTimePicker").minDate(t.val())}),o.datetimepicker(n).on("dp.change",function(){o.val()&&t.data("DateTimePicker").maxDate(o.val())})})}!function(e,a){var s,r,l,c={baidu:"https://api.map.baidu.com/api?ak=rO9tOdEWFfvyGgDkiWqFjxK6&v=1.5&services=false&callback=",google:"https://maps.google.com/maps/api/js?key=AIzaSyB8lorvl6EtqIWz67bjWBruOhm9NYS1e24&callback=",tencent:"https://map.qq.com/api/js?v=2.exp&key=7I5BZ-QUE6R-JXLWV-WTVAA-CJMYF-7PBBI&callback=",gaode:"https://webapi.amap.com/maps?v=1.3&key=3ec311b5db0d597e79422eeb9a6d4449&callback="};function t(t){this.mapType=t,this.ishide=!1,this.isshow=!1,this.toshow=!1,this.marker=null,this.infoWindow=null,this.mapbox=null,this.locate={lng:116.396795,lat:39.933084},this.map=null}function d(){t.call(this,"baidu")}function p(){t.call(this,"google"),this.infoOpts={width:250,title:""}}function h(){t.call(this,"tencent")}function f(){t.call(this,"gaode"),this.infoOpts={width:250,title:""}}t.prototype.isAPIReady=function(){return!1},t.prototype.setMap=function(){},t.prototype.showInfo=function(){},t.prototype.getAddress=function(t){return""},t.prototype.setLocate=function(t){},t.prototype.loadAPI=function(){var t=this;if(this.isAPIReady())return this.mapbox=a("#"+this.mapType+"map"),this.mapbox.length<1&&(this.mapbox=a('<div id="'+this.mapType+'map" class="mapbox"></div>'),r.append(this.mapbox)),!0;this.mapbox=a('<div id="'+this.mapType+'map" class="mapbox">loading...</div>'),r.append(this.mapbox);var o,n,i="mapload"+(new Date).getTime();return e[i]=function(){t.setMap(),delete e[i]},o=c[this.mapType]+i,(n=document.createElement("script")).type="text/javascript",n.src=o,document.body.appendChild(n),!1},t.prototype.bindEvents=function(){var t=this;a("#txtTitle").unbind().blur(function(){t.showInfo()}),a("#txtContent").unbind().blur(function(){t.showInfo()})},t.prototype.setInfoContent=function(){if(this.infoWindow){var t="<b>当前位置</b>",o='<p style="line-height:1.6em;"></p>';if(this.infoWindow.setTitle)this.infoWindow.setTitle(t),this.infoWindow.setContent(o);else{this.infoWindow.setContent('<h3><b>当前位置</b></h3><div style="width:250px"><p style="line-height:1.6em;"></p></div>')}}},t.prototype.showLocationInfo=function(t,o){this.showInfo();var n=this.getAddress(o),i={};"function"==typeof t.lng?(i.lng=t.lng(),i.lat=t.lat()):(i.lng=t.lng,i.lat=t.lat),l(n,i)},t.prototype.show=function(){this.ishide=!1,this.setMap(),this.showInfo()},t.prototype.hide=function(){this.ishide=!0,this.infoWindow&&this.infoWindow.close(),this.mapbox&&a(this.mapbox).remove()},((d.prototype=new t).constructor=d).prototype.isAPIReady=function(){return!!e.BMap},d.prototype.setMap=function(){var n=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var t=n.map=new BMap.Map(this.mapbox.attr("id"));t.addControl(new BMap.NavigationControl),t.addControl(new BMap.ScaleControl),t.addControl(new BMap.OverviewMapControl),t.enableScrollWheelZoom();var o=new BMap.Point(this.locate.lng,this.locate.lat);t.centerAndZoom(o,15),this.marker=new BMap.Marker(o),this.marker.enableDragging();var i=new BMap.Geocoder;this.marker.addEventListener("dragend",function(o){i.getLocation(o.point,function(t){n.showLocationInfo(o.point,t)})}),this.marker.addEventListener("click",function(o){i.getLocation(o.point,function(t){n.showLocationInfo(o.point,t)})}),t.addOverlay(this.marker),i.getLocation(o,function(t){n.showLocationInfo(o,t)}),this.infoWindow=new BMap.InfoWindow("",{width:250,title:""}),this.bindEvents(),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},d.prototype.showInfo=function(){this.ishide||(this.isshow?(this.setInfoContent(),this.marker.openInfoWindow(this.infoWindow)):this.toshow=!0)},d.prototype.getAddress=function(t){var o=t.addressComponents;if(o)return o.province+", "+o.city+", "+o.district+", "+o.street+", "+o.streetNumber},d.prototype.setLocate=function(t){var n=new BMap.Geocoder,i=this;n.getPoint(t,function(o){o?(i.map.centerAndZoom(o,11),i.marker.setPosition(o),n.getLocation(o,function(t){i.showLocationInfo(o,t)})):toastr.warning("地址信息不正确，定位失败")},"")},((p.prototype=new t).constructor=p).prototype.isAPIReady=function(){return e.google&&e.google.maps},p.prototype.setMap=function(){var o=this;if(!this.isshow&&!this.ishide&&this.loadAPI()&&!(this.mapbox.length<1)){var t=o.map=new google.maps.Map(this.mapbox[0],{zoom:15,draggable:!0,scaleControl:!0,streetViewControl:!0,zoomControl:!0}),n=new google.maps.LatLng(this.locate);t.panTo(n),this.marker=new google.maps.Marker({position:n,map:t,draggable:!0});var i=new google.maps.Geocoder;this.marker.addListener("dragend",function(){n=o.marker.getPosition(),i.geocode({location:n},function(t){o.showLocationInfo(n,t)})}),this.marker.addListener("click",function(){n=o.marker.getPosition(),i.geocode({location:n},function(t){o.showLocationInfo(n,t)})}),this.bindEvents(),i.geocode({location:n},function(t){o.showLocationInfo(n,t)}),this.infoWindow=new google.maps.InfoWindow({map:t}),this.infoWindow.setPosition(n),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},p.prototype.showInfo=function(){this.ishide||(this.isshow?(this.infoWindow.setOptions({position:this.marker.getPosition()}),this.setInfoContent()):this.toshow=!0)},p.prototype.getAddress=function(t,o){if(t&&t[0])return t[0].formatted_address},p.prototype.setLocate=function(t){var n=new google.maps.Geocoder,i=this;n.getPoint(t,function(o){o?(i.map.centerAndZoom(o,11),i.marker.setPosition(o),n.getLocation(o,function(t){i.showLocationInfo(o,t)})):toastr.warning("地址信息不正确，定位失败")},"")},((h.prototype=new t).constructor=h).prototype.isAPIReady=function(){return e.qq&&e.qq.maps},h.prototype.setMap=function(){var o=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var t=o.map=new qq.maps.Map(this.mapbox[0],{zoom:15});new qq.maps.ScaleControl({align:qq.maps.ALIGN.BOTTOM_LEFT,margin:qq.maps.Size(85,15),map:t});var n=new qq.maps.LatLng(this.locate.lat,this.locate.lng);t.panTo(n),this.marker=new qq.maps.Marker({position:n,draggable:!0,map:t}),this.marker.setAnimation(qq.maps.MarkerAnimation.DOWN);var i=new qq.maps.Geocoder({complete:function(t){o.showLocationInfo(n,t)}});qq.maps.event.addListener(this.marker,"click",function(){n=o.marker.getPosition(),i.getAddress(n)}),qq.maps.event.addListener(this.marker,"dragend",function(){n=o.marker.getPosition(),i.getAddress(n)}),i.getAddress(n),this.bindEvents(),this.infoWindow=new qq.maps.InfoWindow({map:t}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},h.prototype.showInfo=function(){this.ishide||(this.isshow?(this.infoWindow.open(),this.setInfoContent(),this.infoWindow.setPosition(this.marker.getPosition())):this.toshow=!0)},h.prototype.getAddress=function(t){if(t&&t.detail)return t.detail.address},h.prototype.setLocate=function(t){var n=this;new qq.maps.Geocoder({complete:function(t){if(t&&t.detail&&t.detail.location){var o=t.detail.location;n.map.setCenter(o),n.marker.setPosition(o),n.showLocationInfo(o,t)}else toastr.warning("地址信息不正确，定位失败")},error:function(t){toastr.warning("地址信息不正确，定位失败")}}).getLocation(t)},((f.prototype=new t).constructor=f).prototype.isAPIReady=function(){return!!e.AMap},f.prototype.setMap=function(){var i=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var o=i.map=new AMap.Map(this.mapbox.attr("id"),{resizeEnable:!0,dragEnable:!0,zoom:13});o.plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView"],function(){o.addControl(new AMap.ToolBar),o.addControl(new AMap.Scale),o.addControl(new AMap.OverView)}),a("[name=txtLang]").unbind().on("change",function(){var t=a(this).val();t&&o.setLang(t)}).trigger("change");var n=new AMap.LngLat(this.locate.lng,this.locate.lat);o.setCenter(n),this.marker=new AMap.Marker({position:n,map:o}),this.marker.setDraggable(!0),this.infoWindow=new AMap.InfoWindow,this.infoWindow.open(o,n),o.plugin(["AMap.Geocoder"],function(){var t=new AMap.Geocoder;i.marker.on("dragend",function(n){t.getAddress(n.lnglat,function(t,o){i.showLocationInfo(n.lnglat,o)})}),i.marker.on("click",function(n){t.getAddress(n.lnglat,function(t,o){i.showLocationInfo(n.lnglat,o)})}),t.getAddress(n,function(t,o){i.showLocationInfo(n,o)})}),this.bindEvents(),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},f.prototype.showInfo=function(){this.ishide||(this.isshow?(this.setInfoContent(),this.infoWindow.setPosition(this.marker.getPosition())):this.toshow=!0)},f.prototype.getAddress=function(t){return t.regeocode.formattedAddress},f.prototype.setLocate=function(t){var n=new AMap.Geocoder,i=this;n.getPoint(t,function(o){o?(i.map.centerAndZoom(o,11),i.marker.setPosition(o),n.getLocation(o,function(t){i.showLocationInfo(o,t)})):toastr.warning("地址信息不正确，定位失败")},"")},e.InitMap=function(t,o,n,i){switch(s&&s.hide(),r=a(o),l=n,t.toLowerCase()){case"baidu":s=new d;break;case"google":s=new p;break;case"tencent":case"qq":s=new h;break;case"gaode":s=new f}if(!s)return toastr.warning("不支持该地图类型");if(i){if("string"==typeof i){var e=i.split(",");i={lng:parseFloat(e[0]),lat:parseFloat(e[1])}}s.locate=i}return s.setMap(),s}}(window,jQuery),window.stop_ajax=!1,jQuery(function(r){var t=r(".breadcrumb"),o=t.data("menu");if(o){var n=r(".side-nav a[data-key="+o+"]"),i=[];if(0<n.length)if(n.is(".menu_top"))i.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+n.find("i").attr("class")+'"></i>&nbsp;'+n.text()+"</a></li>");else{var e=n.parents(".collapse").eq(0);e.addClass("show"),n.addClass("active");var a=e.siblings(".card-header").find("a.menu_top");i.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+a.find("i").attr("class")+'"></i>&nbsp;'+a.text()+"</a></li>"),i.push('<li class="breadcrumb-item"><a href="javascript:">'+n.text()+"</a></li>")}var s=t.data("title");s&&i.push('<li class="breadcrumb-item active" aria-current="page">'+s+"</li>"),t.html(i.join("\n"))}r(".checkall-btn").click(function(t){var o=r(this).data("target");o||(o="id");var n=r("[name="+o+"]");r(this).is(".active")?n.prop("checked",!1):n.prop("checked",!0)}),r(".checkreverse-btn").click(function(t){var o=r(this).data("target");o||(o="id");for(var n=r("[name="+o+"]"),i=0;i<n.length;i++)n[i].checked?n.eq(i).prop("checked",!1):n.eq(i).prop("checked",!0)}),r(".action-btn").click(function(t){t.preventDefault();var o=r(this).data("action");if(!o)return toastr.error("未知操作");if(o="action"+o.replace(/^[a-z]/,function(t){return t.toUpperCase()}),!window[o]||"function"!=typeof window[o])return toastr.error("未知操作");var n=r(this).data("needChecks");if(void 0===n&&(n=!0),n){var i=r(this).data("target");i||(i="id");var e=r("[name="+i+"]:checked");if(e.length<1)return toastr.warning("请选择需要操作的项目");for(var a=[],s=0;s<e.length;s++)a.push(e.eq(s).val());window[o](a)}else window[o]()}),r("a[rel=ajax]").click(function(t){t.preventDefault();var n=r(this),o=r(this).data("title");o||(o=r(this).text());new Dialog({btns:["确定"],onshow:function(o){r.ajax({url:n.attr("href"),success:function(t){o.html(t)}})}}).show('<p class="loading">加载中...</p>',o)}),r(".nav-tabs a").click(function(t){t.preventDefault(),r(this).tab("show")}),r(".custom-file .custom-file-input").on("change",function(){r(this).parents(".custom-file").find(".custom-file-label").text(r(this).val())}),r(".btn-primary[type=submit]").click(function(t){var o=r(this).parents("form"),n=this,i="BUTTON"==r(n).prop("tagName").toUpperCase(),e=i?r(n).text():r(n).val(),a={url:r(o).attr("action"),type:"POST",dataType:"JSON",success:function(t){window.stop_ajax=!1,i?r(n).text(e):r(n).val(e),1==t.code?dialog.alert(t.msg,function(){t.url?location.href=t.url:location.reload()}):(toastr.warning(t.msg),r(n).removeAttr("disabled"))},error:function(t){window.stop_ajax=!1,i?r(n).text(e):r(n).val(e),r(n).removeAttr("disabled"),toastr.error("服务器处理错误")}};if("multipart/form-data"===o.attr("enctype")){if(!FormData)return window.stop_ajax=!0;a.data=new FormData(o[0]),a.cache=!1,a.processData=!1,a.contentType=!1,a.xhr=function(){var t=r.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){var o=Math.floor(t.loaded/t.total*100);r(n).text(e+"  ("+o+"%)")},!1),t}}else a.data=r(o).serialize();t.preventDefault(),r(this).attr("disabled",!0),window.stop_ajax=!0,r.ajax(a)}),r(".pickuser").click(function(t){var o=r(this).parents(".input-group"),n=o.find("[name=member_id]"),i=o.find("[name=member_info]");dialog.pickUser(r(this).data("url"),function(t){n.val(t.id),i.val("["+t.id+"] "+t.username+(t.mobile?" / "+t.mobile:""))},r(this).data("filter"))}),r(".pick-locate").click(function(t){var o=r(this).parents(".input-group").find("input[type=text]");dialog.pickLocate("qq",function(t){o.val(t.lng+","+t.lat)},o.val())})});