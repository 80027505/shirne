function del(t,o){return dialog.confirm(o,function(){location.href=$(t).attr("href")}),!1}function lang(t){return window.language&&window.language[t]?window.language[t]:t}function randomString(t,o){for(var n="",e=(o=o||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789").length,i=0;i<t;i++){var a=Math.floor(Math.random()*e);n+=o.substring(a,a+1)}return n}function copy_obj(t){return JSON.parse(JSON.stringify(t))}function isObjectValueEqual(t,o){if(!t&&!o)return!0;if(!t||!o)return!1;var n=Object.getOwnPropertyNames(t),e=Object.getOwnPropertyNames(o);if(n.length!=e.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(t[a]!==o[a])return!1}return!0}function array_combine(t,o){for(var n={},e=0;e<t.length&&!(o.length<e+1);e++)n[t[e]]=o[e];return n}function tostring(t){return t&&t.toString?t.toString():""}function callfunc(t,o,n,e){if(n){"string"==typeof n&&(n=n.split(","));var i=n.indexOf("###");0<=i?n[i]=t:n=[t].concat(n)}else n=[t];return window[o]?window[o].apply(e,n):null==t?"":t}function iif(t,o,n){return"0"===t&&(t=0),t?o:n}Number.prototype.format=function(t){void 0===t&&(t=2);for(var o=this.toFixed(t).split("."),n=[],e=o[0].split(""),i=e.length,a=0;a<i;a++)0<a&&a%3==0&&n.unshift(","),n.unshift(e[i-a-1]);return n.join("")+(2==o.length?"."+o[1]:"")},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s+|\s+$)/g,"")}),String.prototype.compile=function(r,t){if(t){var o=[];for(var n in r)o.push(this.compile(r[n]));return o.join("\n")}return this.replace(/\{if\s+([^\}]+)\}([\W\w]*){\/if}/g,function(t,o,n){var e;if(e=o.match(/\s+(=+|<|>)\s+/)){e=e[0];var i=o.split(e);0===i[0].indexOf("@")&&(i[0]=r[i[0].replace("@","")]),0===i[1].indexOf("@")&&(i[1]=r[i[1].replace("@","")]);var a=!1;switch(e=e.trim()){case"==":a=i[0]==i[1];break;case"===":a=i[0]===i[1];break;case">":a=i[0]>i[1];break;case"<":a=i[0]<i[1]}if(a)return n}else if(r[o.replace("@","")])return n;return""}).replace(/\{@([\w\d\.]+)(?:\|([\w\d]+)(?:\s*=\s*([\w\d,\s#]+))?)?\}/g,function(t,o,n,e){if(0<o.indexOf(".")){for(var i=o.split("."),a=r,s=0;s<i.length;s++){if(void 0===a[i[s]]||null===a[i[s]]){a="";break}a=a[i[s]]}return callfunc(a,n,e)}return callfunc(r[o],n,e,r)})};var dialogTpl='<div class="modal fade" id="{@id}" tabindex="-1" role="dialog" aria-labelledby="{@id}Label" aria-hidden="true">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-header">\n                <h4 class="modal-title" id="{@id}Label"></h4>\n                <button type="button" class="close" data-dismiss="modal">\n                    <span aria-hidden="true">&times;</span>\n                    <span class="sr-only">Close</span>\n                </button>\n            </div>\n            <div class="modal-body">\n            </div>\n            <div class="modal-footer">\n                <nav class="nav nav-fill"></nav>\n            </div>\n        </div>\n    </div>\n</div>',dialogIdx=0;function Dialog(t){if(t||(t={}),void 0!==t.btns){"string"==typeof t.btns&&(t.btns=[t.btns]);for(var o=0;o<t.btns.length;o++)"string"==typeof t.btns[o]&&(t.btns[o]={text:t.btns[o]}),t.btns[o].isdefault&&(t.defaultBtn=o);void 0===t.defaultBtn&&(t.defaultBtn=t.btns.length-1,t.btns[t.defaultBtn].isdefault=!0),t.btns[t.defaultBtn]&&!t.btns[t.defaultBtn].type&&(t.btns[t.defaultBtn].type="primary")}this.options=$.extend({id:"dlgModal"+dialogIdx++,header:!0,backdrop:!0,size:"",btns:[{text:"取消",type:"secondary"},{text:"确定",isdefault:!0,type:"primary"}],defaultBtn:1,onsure:null,onshow:null,onshown:null,onhide:null,onhidden:null},t),this.box=$(this.options.id)}Dialog.prototype.generBtn=function(t,o){return t.type&&(t.class="btn-outline-"+t.type),'<a href="javascript:" class="nav-item btn '+(t.class?t.class:"btn-outline-secondary")+'" data-index="'+o+'">'+t.text+"</a>"},Dialog.prototype.show=function(t,o){this.box=$("#"+this.options.id),o||(o="系统提示"),this.box.length<1?($(document.body).append(dialogTpl.replace("modal-body","modal-body"+(this.options.bodyClass?" "+this.options.bodyClass:"")).compile({id:this.options.id})),this.box=$("#"+this.options.id)):this.box.unbind(),this.options.header||this.box.find(".modal-header").remove(),!0!==this.options.backdrop&&this.box.data("backdrop",this.options.backdrop),this.options.keyboard||this.box.data("keyboard",!1);var n=this;Dialog.instance=n;for(var e=[],i=0;i<this.options.btns.length;i++)e.push(this.generBtn(this.options.btns[i],i));this.box.find(".modal-footer .nav").html(e.join("\n"));var a=this.box.find(".modal-dialog");a.removeClass("modal-sm").removeClass("modal-lg"),"sm"==this.options.size?a.addClass("modal-sm"):"lg"==this.options.size&&a.addClass("modal-lg"),this.box.find(".modal-title").text(o);var s=this.box.find(".modal-body");return s.html(t),this.box.on("hide.bs.modal",function(){n.options.onhide&&n.options.onhide(s,n.box),Dialog.instance=null}),this.box.on("hidden.bs.modal",function(){n.options.onhidden&&n.options.onhidden(s,n.box),n.box.remove()}),this.box.on("show.bs.modal",function(){n.options.onshow&&n.options.onshow(s,n.box)}),this.box.on("shown.bs.modal",function(){n.options.onshown&&n.options.onshown(s,n.box)}),this.box.find(".modal-footer .btn").click(function(){var t=!0,o=$(this).data("index");n.options.btns[o].click&&(t=n.options.btns[o].click.apply(this,[s,n.box])),o==n.options.defaultBtn&&n.options.onsure&&(t=n.options.onsure.apply(this,[s,n.box])),!1!==t&&n.box.modal("hide")}),this.box.modal("show"),this},Dialog.prototype.hide=Dialog.prototype.close=function(){return this.box.modal("hide"),this};var dialog={alert:function(t,o,n){var e=!1,i="function"==typeof o;o&&!i&&(n=o);var a={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},s="primary";n?a[n]&&(s="error"==n?"danger":n,n=a[n]):n="information-circle";var r='<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:n,color:s});return new Dialog({btns:"确定",header:!1,onsure:function(){if(i)return o(e=!0)},onhide:function(){!e&&i&&o(!1)}}).show(r,"")},confirm:function(t,o,n,e){var i=!1;"string"==typeof o?(e=o,"function"==typeof n&&(o=n,n=null)):"string"==typeof calcel&&(e=n);var a={success:"checkmark-circle",info:"information-circle",warning:"alert",error:"remove-circle"},s="primary";e?a[e]&&(s="error"==e?"danger":e,e=a[e]):e="information-circle";var r='<div class="row" style="align-items: center;"><div class="col-3 text-right"><i class="ion-md-{@icon} text-{@color}" style="font-size:3em;"></i> </div><div class="col-9" >{@message}</div> </div>'.compile({message:t,icon:e,color:s});return new Dialog({header:!1,backdrop:"static",onsure:function(){if(o&&"function"==typeof o)return i=!0,o()},onhide:function(){if(0==i&&"function"==typeof n)return n()}}).show(r)},prompt:function(o,e,t){var n='<div class="form-group">{@input}</div>',i="请输入信息";return"string"==typeof o?i=o:(i=o.title,o.content&&(n=-1<o.content.indexOf("{@input}")?o.content:o.content+n)),new Dialog({backdrop:"static",onshow:function(t){o&&o.onshow&&o.onshow(t)},onshown:function(t){t.find("[name=confirm_input]").focus(),o&&o.onshown&&o.onshown(t)},onsure:function(t){var o=t.find("[name=confirm_input]").val();if("function"==typeof e){var n=e(o);return!0===n&&!0,n}},onhide:function(){if(!1)return t()}}).show(n.compile({input:'<input type="text" name="confirm_input" class="form-control" />'}),i)},action:function(t,n,o){var e='<div class="list-group"><a href="javascript:" class="list-group-item list-group-item-action">'+t.join('</a><a href="javascript:" class="list-group-item list-group-item-action">')+"</a></div>",i=null,a=new Dialog({bodyClass:"modal-action",backdrop:"static",btns:[{text:"取消",type:"secondary"}],onshow:function(t){(i=t.find(".list-group-item-action")).click(function(t){i.removeClass("active"),$(this).addClass("active");var o=i.index(this);"function"==typeof n?!1!==n(o)&&a.close():a.close()})},onsure:function(t){return!0},onhide:function(){return!0}}).show(e,o||"请选择")},pickList:function(s,o,r){"string"==typeof s&&(s={url:s}),s=$.extend({url:"",name:"对象",searchHolder:"根据名称搜索",idkey:"id",onRow:null,extend:null,rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">[{@id}]&nbsp;<i class="ion-md-person"></i> {@username}&nbsp;&nbsp;&nbsp;<small><i class="ion-md-phone-portrait"></i> {@mobile}</small></a>'},s||{});var c=null,t="";s.extend&&(t='<select name="'+s.extend.name+'" class="form-control"><option value="">'+s.extend.title+"</option></select>"),r||(r={});new Dialog({backdrop:"static",onshown:function(t){var o=t.find(".searchbtn"),n=t.find(".searchtext"),e=t.find(".list-group"),i=!1,a=null;s.extend&&(a=t.find("[name="+s.extend.name+"]"),$.ajax({url:s.extend.url,type:"GET",dataType:"JSON",success:function(t){a.append(s.extend.htmlRow.compile(t.data,!0))}})),o.click(function(){i||(i=!0,e.html('<span class="list-loading">加载中...</span>'),r.key=n.val(),s.extend&&(r[s.extend.name]=a.val()),$.ajax({url:s.url,type:"GET",dataType:"JSON",data:r,success:function(n){i=!1,1===n.code?n.data&&n.data.length?(e.html(s.rowTemplate.compile(n.data,!0)),e.find("a.list-group-item").click(function(){for(var t=$(this).data("id"),o=0;o<n.data.length;o++)if(n.data[o][s.idkey]==t){c=n.data[o],e.find("a.list-group-item").removeClass("active"),$(this).addClass("active");break}})):e.html('<span class="list-loading"><i class="ion-md-warning"></i> 没有检索到'+s.name+"</span>"):e.html('<span class="text-danger"><i class="ion-md-warning"></i> 加载失败</span>')}}))}).trigger("click")},onsure:function(t){return c?"function"==typeof o?o(c):void 0:(toastr.warning("没有选择"+s.name+"!"),!1)}}).show('<div class="input-group">'+t+'<input type="text" class="form-control searchtext" name="keyword" placeholder="'+s.searchHolder+'"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="list-group list-group-picker mt-2"></div>',"请搜索并选择"+s.name)},pickUser:function(t,o){return this.pickList({url:window.get_search_url("member"),name:"会员",searchHolder:"根据会员id或名称，电话来搜索"},t,o)},pickArticle:function(t,o){return this.pickList({url:window.get_search_url("article"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @cover}<div style="background-image:url({@cover})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@description}</div></a>',name:"文章",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("article"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据文章标题搜索"},t,o)},pickProduct:function(t,o){return this.pickList({url:window.get_search_url("product"),rowTemplate:'<a href="javascript:" data-id="{@id}" class="list-group-item list-group-item-action">{if @image}<div style="background-image:url({@image})" class="imgview" ></div>{/if}<div class="text-block">[{@id}]&nbsp;{@title}&nbsp;<br />{@min_price}~{@max_price}</div></a>',name:"产品",idkey:"id",extend:{name:"cate",title:"按分类搜索",url:get_cate_url("product"),htmlRow:'<option value="{@id}">{@html}{@title}</option>'},searchHolder:"根据产品名称搜索"},t,o)},pickLocate:function(t,o,s){var r=null;new Dialog({size:"lg",backdrop:"static",onshown:function(t){var o=t.find(".searchbtn"),n=t.find(".searchtext"),e=t.find(".map"),i=t.find(".mapinfo");e.css("height",.6*$(window).height());var a=InitMap("tencent",e,function(t,o){i.html(t+"&nbsp;"+o.lng+","+o.lat),r=o},s);o.click(function(){var t=n.val();a.setLocate(t)}),t.find(".setToCenter").click(function(t){a.showAtCenter()})},onsure:function(t){return r?"function"==typeof o?o(r):void 0:(toastr.warning("没有选择位置!"),!1)}}).show('<div class="input-group"><input type="text" class="form-control searchtext" name="keyword" placeholder="填写地址检索位置"/><div class="input-group-append"><a class="btn btn-outline-secondary searchbtn"><i class="ion-md-search"></i></a></div></div><div class="map mt-2"></div><div class="float-right mt-2 mapactions"><a href="javascript:" class="setToCenter">定位到地图中心</a></div><div class="mapinfo mt-2 text-muted">未选择位置</div>',"请选择地图位置")}};if(jQuery(function(t){t(document).on("keydown",function(t){if(Dialog.instance){var o=Dialog.instance;13==t.keyCode&&o.box.find(".modal-footer .btn").eq(o.options.defaultBtn).trigger("click")}})}),jQuery.extend(jQuery.fn,{tags:function(t,i){var a=[],s='<span class="badge badge-info">{@label}<input type="hidden" name="'+t+'" value="{@label}"/><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></span>',o=$(this).parents(".form-control"),r=$('<span class="badge-group"></span>'),c=this;this.before(r),this.on("keyup",function(){var t=$(this).val().replace(/，/g,","),o=!1;if(t&&-1<t.indexOf(",")){for(var n=t.split(","),e=0;e<n.length;e++)n[e]=n[e].replace(/^\s|\s$/g,""),n[e]&&-1===a.indexOf(n[e])&&(a.push(n[e]),r.append(s.compile({label:n[e]})),o=!0);c.val(""),o&&i&&i(a)}}).on("blur",function(){var t=$(this).val();t&&$(this).val(t+",").trigger("keyup")}).trigger("blur"),r.on("click",".close",function(){var t=$(this).parents(".badge").find("input").val(),o=a.indexOf(t);o&&a.splice(o,1),$(this).parents(".badge").remove(),i&&i(a)}),o.click(function(){c.focus()})}}),$.fn.datetimepicker){var tooltips={today:"定位当前日期",clear:"清除已选日期",close:"关闭选择器",selectMonth:"选择月份",prevMonth:"上个月",nextMonth:"下个月",selectYear:"选择年份",prevYear:"上一年",nextYear:"下一年",selectDecade:"选择年份区间",selectTime:"选择时间",prevDecade:"上一区间",nextDecade:"下一区间",prevCentury:"上个世纪",nextCentury:"下个世纪"};function transOption(t){if(!t)return{};var o={};for(var n in t)switch(n){case"viewmode":o.viewMode=t[n];break;case"keepopen":o.keepOpen=t[n];break;default:o[n]=t[n]}return o}$(".datepicker").each(function(){var t=$.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},transOption($(this).data()));$(this).datetimepicker(t)}),$(".date-range").each(function(){var t=$(this).find("[name=fromdate],.fromdate"),o=$(this).find("[name=todate],.todate"),n=$.extend({tooltips:tooltips,format:"YYYY-MM-DD",locale:"zh-cn",showClear:!0,showTodayButton:!0,showClose:!0,keepInvalid:!0},$(this).data());t.datetimepicker(n).on("dp.change",function(){t.val()&&o.data("DateTimePicker").minDate(t.val())}),o.datetimepicker(n).on("dp.change",function(){o.val()&&t.data("DateTimePicker").maxDate(o.val())})})}!function(i,a){var s,r,c,l={baidu:"//api.map.baidu.com/api?ak=rO9tOdEWFfvyGgDkiWqFjxK6&v=1.5&services=false&callback=",google:"//maps.google.com/maps/api/js?key=AIzaSyB8lorvl6EtqIWz67bjWBruOhm9NYS1e24&callback=",tencent:"//map.qq.com/api/js?v=2.exp&key=7I5BZ-QUE6R-JXLWV-WTVAA-CJMYF-7PBBI&callback=",gaode:"//webapi.amap.com/maps?v=1.3&key=3ec311b5db0d597e79422eeb9a6d4449&callback="};function t(t){this.mapType=t,this.ishide=!1,this.isshow=!1,this.toshow=!1,this.marker=null,this.infoWindow=null,this.mapbox=null,this.locate={lng:116.396795,lat:39.933084},this.map=null}function d(){t.call(this,"baidu")}function p(){t.call(this,"google"),this.infoOpts={width:250,title:""}}function h(){t.call(this,"tencent")}function u(){t.call(this,"gaode"),this.infoOpts={width:250,title:""}}t.prototype.isAPIReady=function(){return!1},t.prototype.pointToObject=function(){},t.prototype.objectToPoint=function(){},t.prototype.setMap=function(){},t.prototype.showInfo=function(){},t.prototype.getCenter=function(){},t.prototype.getAddress=function(t){return""},t.prototype.setLocate=function(t){},t.prototype.loadAPI=function(){var t=this;if(this.isAPIReady())return this.mapbox=a("#"+this.mapType+"map"),this.mapbox.length<1&&(this.mapbox=a('<div id="'+this.mapType+'map" class="mapbox"></div>'),r.append(this.mapbox)),!0;this.mapbox=a('<div id="'+this.mapType+'map" class="mapbox">loading...</div>'),r.append(this.mapbox);var o,n,e="mapload"+(new Date).getTime();return i[e]=function(){t.setMap(),delete i[e]},o=l[this.mapType]+e,(n=document.createElement("script")).type="text/javascript",n.src=o,document.body.appendChild(n),!1},t.prototype.setInfoContent=function(){if(this.infoWindow){var t="<b>当前位置</b>",o='<p style="line-height:1.6em;"></p>';if(this.infoWindow.setTitle)this.infoWindow.setTitle(t),this.infoWindow.setContent(o);else{this.infoWindow.setContent('<h3><b>当前位置</b></h3><div style="width:250px"><p style="line-height:1.6em;"></p></div>')}}},t.prototype.showAtCenter=function(){var t=this.getCenter();this.showInfo(t)},t.prototype.showLocationInfo=function(t,o){this.showInfo();var n=this.getAddress(o),e={};"function"==typeof t.lng?(e.lng=t.lng(),e.lat=t.lat()):(e.lng=t.lng,e.lat=t.lat),c(n,e)},t.prototype.show=function(){this.ishide=!1,this.setMap(),this.showInfo()},t.prototype.hide=function(){this.ishide=!0,this.infoWindow&&this.infoWindow.close(),this.mapbox&&a(this.mapbox).remove()},((d.prototype=new t).constructor=d).prototype.isAPIReady=function(){return!!i.BMap},d.prototype.setMap=function(){var n=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var t=n.map=new BMap.Map(this.mapbox.attr("id"));t.addControl(new BMap.NavigationControl),t.addControl(new BMap.ScaleControl),t.addControl(new BMap.OverviewMapControl),t.enableScrollWheelZoom();var o=this.objectToPoint(this.locate);t.centerAndZoom(o,15),this.marker=new BMap.Marker(o),this.marker.enableDragging();var e=new BMap.Geocoder;this.marker.addEventListener("dragend",function(o){e.getLocation(o.point,function(t){n.showLocationInfo(o.point,t)})}),this.marker.addEventListener("click",function(o){e.getLocation(o.point,function(t){n.showLocationInfo(o.point,t)})}),t.addOverlay(this.marker),e.getLocation(o,function(t){n.showLocationInfo(o,t)}),this.infoWindow=new BMap.InfoWindow("",{width:250,title:""}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},d.prototype.pointToObject=function(t){return{lng:t.lng,lat:t.lat}},d.prototype.objectToPoint=function(t){return new BMap.Point(parseFloat(t.lng),parseFloat(t.lat))},d.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},d.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.panTo(new BMap.Point(t.lng,t.lat))),this.setInfoContent(),this.marker.openInfoWindow(this.infoWindow)):this.toshow=!0)},d.prototype.getAddress=function(t){var o=t.addressComponents;if(o)return o.province+", "+o.city+", "+o.district+", "+o.street+", "+o.streetNumber},d.prototype.setLocate=function(t){var n=new BMap.Geocoder,e=this;n.getPoint(t,function(o){o?(e.map.centerAndZoom(o,11),e.marker.setPosition(o),n.getLocation(o,function(t){e.showLocationInfo(o,t)})):toastr.warning("地址信息不正确，定位失败")},"")},((p.prototype=new t).constructor=p).prototype.isAPIReady=function(){return i.google&&i.google.maps},p.prototype.setMap=function(){var o=this;if(!this.isshow&&!this.ishide&&this.loadAPI()&&!(this.mapbox.length<1)){var t=o.map=new google.maps.Map(this.mapbox[0],{zoom:15,draggable:!0,scaleControl:!0,streetViewControl:!0,zoomControl:!0}),n=this.objectToPoint(this.locate);t.panTo(n),this.marker=new google.maps.Marker({position:n,map:t,draggable:!0});var e=new google.maps.Geocoder;this.marker.addListener("dragend",function(){n=o.marker.getPosition(),e.geocode({location:n},function(t){o.showLocationInfo(n,t)})}),this.marker.addListener("click",function(){n=o.marker.getPosition(),e.geocode({location:n},function(t){o.showLocationInfo(n,t)})}),e.geocode({location:n},function(t){o.showLocationInfo(n,t)}),this.infoWindow=new google.maps.InfoWindow({map:t}),this.infoWindow.setPosition(n),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},p.prototype.pointToObject=function(t){return{lng:t.lng,lat:t.lat}},p.prototype.objectToPoint=function(t){return new google.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng))},p.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},p.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.setPosition(this.objectToPoint(t))),this.infoWindow.setOptions({position:this.marker.getPosition()}),this.setInfoContent()):this.toshow=!0)},p.prototype.getAddress=function(t,o){if(t&&t[0])return t[0].formatted_address},p.prototype.setLocate=function(t){var n=new google.maps.Geocoder,e=this;n.getPoint(t,function(o){o?(e.map.centerAndZoom(o,11),e.marker.setPosition(o),n.getLocation(o,function(t){e.showLocationInfo(o,t)})):toastr.warning("地址信息不正确，定位失败")},"")},((h.prototype=new t).constructor=h).prototype.isAPIReady=function(){return i.qq&&i.qq.maps},h.prototype.pointToObject=function(t){return{lng:t.getLng(),lat:t.getLat()}},h.prototype.objectToPoint=function(t){return new qq.maps.LatLng(parseFloat(t.lat),parseFloat(t.lng))},h.prototype.setMap=function(){var o=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var t=o.map=new qq.maps.Map(this.mapbox[0],{zoom:15});new qq.maps.ScaleControl({align:qq.maps.ALIGN.BOTTOM_LEFT,margin:qq.maps.Size(85,15),map:t});var n=this.objectToPoint(this.locate);t.panTo(n),this.marker=new qq.maps.Marker({position:n,draggable:!0,map:t}),this.marker.setAnimation(qq.maps.MarkerAnimation.DOWN);var e=new qq.maps.Geocoder({complete:function(t){o.showLocationInfo(n,t)}});qq.maps.event.addListener(this.marker,"click",function(){n=o.marker.getPosition(),e.getAddress(n)}),qq.maps.event.addListener(this.marker,"dragend",function(){n=o.marker.getPosition(),e.getAddress(n)}),e.getAddress(n),this.infoWindow=new qq.maps.InfoWindow({map:t}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},h.prototype.getCenter=function(){var t=this.map.getCenter();return this.pointToObject(t)},h.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&(this.locate=t,this.marker.setPosition(this.objectToPoint(t))),this.infoWindow.setPosition(this.marker.getPosition()),this.infoWindow.open(),this.setInfoContent()):this.toshow=!0)},h.prototype.getAddress=function(t){if(t&&t.detail)return t.detail.address},h.prototype.setLocate=function(t){var n=this;new qq.maps.Geocoder({complete:function(t){if(t&&t.detail&&t.detail.location){var o=t.detail.location;n.map.setCenter(o),n.marker.setPosition(o),n.showLocationInfo(o,t)}else toastr.warning("地址信息不正确，定位失败")},error:function(t){toastr.warning("地址信息不正确，定位失败")}}).getLocation(t)},((u.prototype=new t).constructor=u).prototype.isAPIReady=function(){return!!i.AMap},u.prototype.setMap=function(){var e=this;if(!this.isshow&&!this.ishide&&this.loadAPI()){var o=e.map=new AMap.Map(this.mapbox.attr("id"),{resizeEnable:!0,dragEnable:!0,zoom:13});o.plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView"],function(){o.addControl(new AMap.ToolBar),o.addControl(new AMap.Scale),o.addControl(new AMap.OverView)}),a("[name=txtLang]").unbind().on("change",function(){var t=a(this).val();t&&o.setLang(t)}).trigger("change");var n=this.objectToPoint(this.locate);o.setCenter(n),this.marker=new AMap.Marker({position:n,map:o}),this.marker.setDraggable(!0),this.infoWindow=new AMap.InfoWindow,this.infoWindow.open(o,n),o.plugin(["AMap.Geocoder"],function(){var t=new AMap.Geocoder;e.marker.on("dragend",function(n){t.getAddress(n.lnglat,function(t,o){e.showLocationInfo(n.lnglat,o)})}),e.marker.on("click",function(n){t.getAddress(n.lnglat,function(t,o){e.showLocationInfo(n.lnglat,o)})}),t.getAddress(n,function(t,o){e.showLocationInfo(n,o)})}),this.isshow=!0,this.toshow&&(this.showInfo(),this.toshow=!1)}},u.prototype.pointToObject=function(t){return{lng:t.getLng(),lat:t.getLat()}},u.prototype.objectToPoint=function(t){return new AMap.LngLat(t.lng,t.lat)},u.prototype.getCenter=function(){var t=this.map.center();return this.pointToObject(t)},u.prototype.showInfo=function(t){this.ishide||(this.isshow?(t&&this.marker.setPosition(this.objectToPoint(t)),this.setInfoContent(),this.infoWindow.setPosition(this.marker.getPosition())):this.toshow=!0)},u.prototype.getAddress=function(t){return t.regeocode.formattedAddress},u.prototype.setLocate=function(t){var n=new AMap.Geocoder,e=this;n.getPoint(t,function(o){o?(e.map.centerAndZoom(o,11),e.marker.setPosition(o),n.getLocation(o,function(t){e.showLocationInfo(o,t)})):toastr.warning("地址信息不正确，定位失败")},"")},i.InitMap=function(t,o,n,e){switch(s&&s.hide(),r=a(o),c=n,t.toLowerCase()){case"baidu":s=new d;break;case"google":s=new p;break;case"tencent":case"qq":s=new h;break;case"gaode":s=new u}if(!s)return toastr.warning("不支持该地图类型");if(e){if("string"==typeof e){var i=e.split(",");e={lng:parseFloat(i[0]),lat:parseFloat(i[1])}}s.locate=e}return s.setMap(),s}}(window,jQuery),window.stop_ajax=!1,jQuery(function(r){var t=r(".breadcrumb"),o=t.data("menu");if(o){var n=r(".side-nav a[data-key="+o+"]"),e=[];if(0<n.length)if(n.is(".menu_top"))e.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+n.find("i").attr("class")+'"></i>&nbsp;'+n.text()+"</a></li>");else{var i=n.parents(".collapse").eq(0);i.addClass("show"),n.addClass("active");var a=i.siblings(".card-header").find("a.menu_top");e.push('<li class="breadcrumb-item"><a href="javascript:"><i class="'+a.find("i").attr("class")+'"></i>&nbsp;'+a.text()+"</a></li>"),e.push('<li class="breadcrumb-item"><a href="javascript:">'+n.text()+"</a></li>")}var s=t.data("title");s&&e.push('<li class="breadcrumb-item active" aria-current="page">'+s+"</li>"),t.html(e.join("\n"))}r(".checkall-btn").click(function(t){var o=r(this).data("target");o||(o="id");var n=r("[name="+o+"]");r(this).is(".active")?n.prop("checked",!1):n.prop("checked",!0)}),r(".checkreverse-btn").click(function(t){var o=r(this).data("target");o||(o="id");for(var n=r("[name="+o+"]"),e=0;e<n.length;e++)n[e].checked?n.eq(e).prop("checked",!1):n.eq(e).prop("checked",!0)}),r(".action-btn").click(function(t){t.preventDefault();var o=r(this).data("action");if(!o)return toastr.error("未知操作");if(o="action"+o.replace(/^[a-z]/,function(t){return t.toUpperCase()}),!window[o]||"function"!=typeof window[o])return toastr.error("未知操作");var n=r(this).data("needChecks");if(void 0===n&&(n=!0),n){var e=r(this).data("target");e||(e="id");var i=r("[name="+e+"]:checked");if(i.length<1)return toastr.warning("请选择需要操作的项目");for(var a=[],s=0;s<i.length;s++)a.push(i.eq(s).val());window[o](a)}else window[o]()}),r(".operations .btn").tooltip(),r("a[rel=ajax]").click(function(t){t.preventDefault();var n=r(this),o=r(this).data("title");o||(o=r(this).text()),o||(o=r(this).attr("title"));new Dialog({btns:["确定"],onshow:function(o){r.ajax({url:n.attr("href"),success:function(t){o.html(t)}})}}).show('<p class="loading">'+lang("loading...")+"</p>",o)}),r(".link-confirm").click(function(t){t.preventDefault(),t.stopPropagation();var o=r(this).data("confirm"),n=r(this).attr("href");(o=o.replace(/(\\n|\n)+/g,"<br />"))||(o=lang("Confirm operation?")),dialog.confirm(o,function(){r.ajax({url:n,dataType:"JSON",success:function(t){dialog.alert(t.msg),1==t.code&&(t.url?location.href=t.url:location.reload())},error:function(){dialog.alert(lang("Server error."))}})})}),r(".img-view").click(function(t){t.preventDefault(),t.stopPropagation();var o=r(this).attr("href");o||(o=r(this).data("img")),dialog.alert('<a href="'+o+'" class="d-block text-center" target="_blank"><img class="img-fluid" src="'+o+'" /></a><div class="text-muted text-center">点击图片在新页面放大查看</div>',null,"查看图片")}),r(".nav-tabs a").click(function(t){t.preventDefault(),r(this).tab("show")}),r(".custom-file .custom-file-input").on("change",function(){r(this).parents(".custom-file").find(".custom-file-label").text(r(this).val())}),r(".btn-primary[type=submit]").click(function(t){var o=r(this).parents("form");if(o.is(".noajax"))return!0;var n=this,e="BUTTON"==r(n).prop("tagName").toUpperCase(),i=e?r(n).text():r(n).val(),a={url:r(o).attr("action"),type:"POST",dataType:"JSON",success:function(t){window.stop_ajax=!1,e?r(n).text(i):r(n).val(i),1==t.code?dialog.alert(t.msg,function(){t.url?location.href=t.url:location.reload()}):(toastr.warning(t.msg),r(n).removeAttr("disabled"))},error:function(t){window.stop_ajax=!1,e?r(n).text(i):r(n).val(i),r(n).removeAttr("disabled"),toastr.error("服务器处理错误")}};if("multipart/form-data"===o.attr("enctype")){if(!FormData)return window.stop_ajax=!0;a.data=new FormData(o[0]),a.cache=!1,a.processData=!1,a.contentType=!1,a.xhr=function(){var t=r.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",function(t){var o=Math.floor(t.loaded/t.total*100);r(n).text(i+"  ("+o+"%)")},!1),t}}else a.data=r(o).serialize();t.preventDefault(),r(this).attr("disabled",!0),window.stop_ajax=!0,r.ajax(a)}),r(".pickuser").click(function(t){var o=r(this).parents(".input-group"),n=o.find("[name=member_id]"),e=o.find("[name=member_info]");dialog.pickUser(function(t){n.val(t.id),e.val("["+t.id+"] "+t.username+(t.mobile?" / "+t.mobile:""))},r(this).data("filter"))}),r(".pick-locate").click(function(t){var o=r(this).parents(".input-group").find("input[type=text]");dialog.pickLocate("qq",function(t){o.val(t.lng+","+t.lat)},o.val())})});
//# sourceMappingURL=app.min.js.map
